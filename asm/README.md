# アセンブラ

## 基本的な文法
* [alpha-guide.pdf](http://www.cs.cmu.edu/afs/cs/academic/class/15213-f98/doc/alpha-guide.pdf)に
  大体のことが書いてある

* INSTRUCTION ::= (LABEL) MNEMONIC ARGUMENTS
  * LABEL : アルファベットまたは`.`、`_`から始まり、それらと数字からなる文字列
    * ニーモニックと重複してはいけない
    * なくてもよい。また、命令と別の行でも同じ行でもよい。
    * 1つの命令に複数のラベルを付けられる
    * ラベルの後には`:`をつけることにしました
  * MNEMONIC : ニーモニック。規定の文字列
  * ARGUMENTS : 引数。','によって区切られる
    * 個々の引数
      * `$0` 〜 `$31`  : 整数レジスタ
      * `$f0` 〜 `$f31` : 浮動小数レジスタ
      * 即値は特に装飾なし
        * `0x`をつけると十六進数として扱われる

* コメント
  * `#`から行末まで

* ラベルにおいて大文字と小文字は区別される

* ニーモニックにおいては大文字と小文字は区別されない

## 使用方法

```
omake
./asagumo <filename> <options>
```

### 入力
* アセンブリファイル(*.s)をコマンドライン引数として指定します

### 出力
* 入力ファイルの拡張子を除いたファイルに機械語を出力します
  * ただし現在はファイル名の末尾2文字を削るという超絶雑実装です
  * "-o"オプションで別ファイルを指定できる
* また、同時に標準出力に解析結果を出力します

### オプション
* -o [filename]
  * 機械語の出力ファイルを指定する
  * 上記の通り、デフォルトは入力ファイルの末尾2文字を削ったもの

### エラー処理
* 引数に存在しないラベルが与えられた際にエラーを吐きます
* ラベルが重複した際にエラーを吐きます
* 命令のフォーマットが合わない時にエラーを吐きます
  * 引数が過剰な場合や形式が合わない場合など
* 即値が表現できる範囲を超えた場合にエラーを吐きます
  * 十進数の場合は符号の有無を区別
  * ラベルによるディスプレースメントも十進数と同様
  * 十六進数の場合は命令の形式によらず符号無しとして扱う
